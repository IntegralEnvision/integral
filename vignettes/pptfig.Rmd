---
title: "pptfig overview and examples"
author: "Eben Pendleton"
date: "2021-02-15"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{pptfig overview and examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction
Welcome to an overview and examples for Integral's PowerPoint theme, __ic_ppttheme()__
and figure function, __ic_ic_pptfig()__.
The first step is to load the library.
```{r setup}
# load the library
library(integral)
```
The library has two functions, ic_ppttheme() which is a theme associated with 
ggplot2 and ic_pptfig() which handles placing the figures in
the PowerPoint template. 

## ic_ppttheme()
This theme is loaded from the library in the example below
You can add this to any ggplot to get a consistent theme
```{r}
theme <- integral::ic_ppttheme()
```

## ic_pptfig()
ic_pptfig() handles placing the figures in
the PowerPoint template. 

An example using ic_ppttheme with defaults
```{r}
# used to read data for this example
library(dataRetrieval)
# library in this vignette
library(integral)
# library for graphics creation
library(ggplot2)

### Set Theme
theme <- integral::ic_ppttheme()

###Data
Q <- dataRetrieval::readNWISuv(site = "01114500", parameterCd = "00060", startDate = as.Date("2020-01-01"))

###Figure
p <- ggplot() +
  geom_path(data = Q, aes(x = dateTime, y = X_00060_00000)) +
  geom_hline(yintercept = 200, color = "red", size = 1.5) +
  annotate("text", x = as.POSIXct("2020-04-01"), y = 200, label = "Line", vjust = 1.8) +
  labs(title = "USGS Stream Gage 01114500, 2020", x = NULL, y = "Discharge (cfs)") +
  theme

### Minimal example
my_pres <- ic_pptfig(
  fig = p, 
  fignum = 1, 
  author = "J. Doe", 
  doctitle1 = "Discharge at USGS Stream Gage 01114500")

# saves out the pptx file
print(my_pres, "Output_default.pptx")
```


An example using non-default settings is below.
```{r}
# used to read data for this example
library(dataRetrieval)
# library in this vignette
library(integral)
# library for graphics creation
library(ggplot2)

###Theme
theme <- integral::ic_ppttheme()

###Data
Q <- dataRetrieval::readNWISuv(site = "01114500", parameterCd = "00060", startDate = as.Date("2020-01-01"))

###Figure
p <- ggplot() +
  geom_path(data = Q, aes(x = dateTime, y = X_00060_00000)) +
  geom_hline(yintercept = 200, color = "red", size = 1.5) +
  annotate("text", x = as.POSIXct("2020-04-01"), y = 200, label = "Line", vjust = 1.8) +
  labs(title = "USGS Stream Gage 01114500, 2020", x = NULL, y = "Discharge (cfs)") +
  theme

###pptfig
### landscape 11 x 8.5
my_pres <- ic_pptfig(
  size = "ledger", 
  orientation = "L", 
  fig = p, 
  section = "D", 
  fignum = 1, 
  note = "Note: Data pulled using readNWISuv.", 
  author = "J. Doe", 
  doctitle1 = "Discharge at USGS Stream Gage 01114500",
  doctitle2 = "Project Description 1", 
  doctitle3 = "Project Description 2", 
  draft = "",
  pc = "",
  showpath = F
  )

print(my_pres, "Output_L_ledger.pptx")
```



